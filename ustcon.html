<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>USTCON - Reingold's Algorithm - VisualTCS</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/graph.css">
</head>
<body>
    <!-- Top Navigation -->
    <nav class="top-nav">
        <div class="nav-left">
            <a href="index.html" class="home-button">
                <svg viewBox="0 0 16 16" fill="currentColor">
                    <path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L8 2.207l6.646 6.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.707 1.5Z"/>
                    <path d="m8 3.293 6 6V13.5a1.5 1.5 0 0 1-1.5 1.5h-9A1.5 1.5 0 0 1 2 13.5V9.293l6-6Z"/>
                </svg>
                Home
            </a>
            <div class="page-title">USTCON - Reingold's Algorithm</div>
        </div>
    </nav>

    <!-- Main Two-Column Layout -->
    <div class="main-layout">
        <!-- Left Panel: Input Graph -->
        <div class="left-panel">
            <div class="panel-header">
                <h2>Input Graph</h2>
            </div>
            <div class="canvas-container">
                <canvas id="inputCanvas"></canvas>
            </div>
        </div>

        <!-- Right Panel: Algorithm Visualization -->
        <div class="right-panel">
            <div class="panel-header">
                <h2>Algorithm Visualization</h2>
            </div>
            <div class="canvas-container">
                <canvas id="algoCanvas"></canvas>
            </div>
        </div>
    </div>

    <!-- Collapsible Control Panel -->
    <div class="control-panel" id="controlPanel">
        <div class="control-panel-header" onclick="toggleControlPanel()">
            <div class="control-panel-title">
                <span>‚öôÔ∏è</span>
                <span>Controls</span>
            </div>
            <div class="toggle-icon">‚ñº</div>
        </div>
        <div class="control-panel-content">
            <div class="control-group">
                <label>Actions</label>
                <div class="control-row">
                    <button class="primary" id="runAlgoBtn">‚ñ∂ Run Algorithm</button>
                    <button id="prevBtn">‚óÄ Previous</button>
                    <button id="nextBtn">Next ‚ñ∂</button>
                    <button id="clearBtn">üóë Clear</button>
                </div>
            </div>

            <div class="control-group">
                <label>Instructions</label>
                <div style="font-size: 12px; color: #8b949e; line-height: 1.6;">
                    <p style="margin-bottom: 6px;"><strong>Click</strong> to add a node to the input graph</p>
                    <p style="margin-bottom: 6px;"><strong>Click + Drag</strong> between nodes to create an edge</p>
                    <p style="margin-bottom: 6px;"><strong>Double-click once</strong> to set source node (green)</p>
                    <p style="margin-bottom: 6px;"><strong>Double-click again</strong> on different node to set target (red)</p>
                    <p style="margin-bottom: 6px;"><strong>Run Algorithm</strong> to see Reingold's transformation steps</p>
                    <p style="margin-bottom: 6px;"><strong>Step through</strong> to see each stage of the algorithm</p>
                </div>
            </div>
            
            <div id="statusMsg" style="margin-top: 10px; padding: 8px; border-radius: 6px; font-size: 12px; text-align: center;"></div>
        </div>
    </div>

    <!-- Algorithm Step Info Panel -->
    <div class="info-panel collapsed" id="stepPanel">
        <div class="info-panel-header">
            <h3>üìä Algorithm Progress</h3>
            <button class="close-panel-btn" onclick="toggleStepPanel()">√ó</button>
        </div>
        <div class="info-panel-content">
            <div class="progress-container">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill" style="width: 0%;"></div>
                </div>
                <div class="step-counter" id="stepCounter">Step 0 of 0</div>
            </div>
            
            <div class="step-description" id="stepDescription">
                <h4>Algorithm Not Started</h4>
                <p>Set up your graph and click "Run Algorithm" to begin.</p>
            </div>
        </div>
    </div>

    <!-- Toggle button for step panel -->
    <button class="toggle-info-btn" id="toggleStepBtn" onclick="toggleStepPanel()">
        üìä View Progress
    </button>

    <script type="module" src="js/ustcon_lib/ustcon_canvas.js"></script>
    <script src="page_js/bfsAndDfsPage.js"></script>
    <script type="module">
        // Initialize canvases after DOM is ready
        import { resizeCanvas as resizeInputCanvas } from './js/graph_lib/graph_draw.js';
        import { resizeCanvas as resizeAlgoCanvas } from './js/ustcon_lib/ustcon_draw.js';
        
        window.addEventListener('load', () => {
            const inputCanvas = document.getElementById('inputCanvas');
            const algoCanvas = document.getElementById('algoCanvas');
            
            // Force canvas resize after layout is complete
            setTimeout(() => {
                if (inputCanvas) resizeInputCanvas(inputCanvas);
                if (algoCanvas) resizeAlgoCanvas(algoCanvas);
            }, 100);
        });
    </script>
    <script>
        function toggleControlPanel() {
            const panel = document.getElementById('controlPanel');
            panel.classList.toggle('collapsed');
        }

        function toggleStepPanel() {
            const panel = document.getElementById('stepPanel');
            const btn = document.getElementById('toggleStepBtn');
            panel.classList.toggle('collapsed');
            btn.classList.toggle('hidden');
        }

        // Start with control panel open and step panel visible
        document.addEventListener('DOMContentLoaded', () => {
            const controlPanel = document.getElementById('controlPanel');
            controlPanel.classList.remove('collapsed');
            
            // Show step panel when algorithm runs
            const runBtn = document.getElementById('runReingold');
            if (runBtn) {
                runBtn.addEventListener('click', () => {
                    setTimeout(() => {
                        const stepPanel = document.getElementById('stepPanel');
                        if (stepPanel.classList.contains('collapsed')) {
                            toggleStepPanel();
                        }
                    }, 100);
                });
            }
        });
    </script>
</body>
</html>
